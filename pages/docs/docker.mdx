# Docker 部署


import { Callout, Steps } from "nextra/components";
import { Card, Cards, Callout } from 'nextra/components';
import { UilExternalLinkAlt } from '@components/Icons/ExternalLinkAlt';
import { UilArrowCircleUp } from '@components/Icons/ArrowCircleUp';

<Steps>
### 安装 Docker

如果你的服务器在国内，建议使用阿里云的镜像加速，安装命令如下：

```bash
curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun
```
在国外，可以直接使用官方脚本安装：

```bash
curl -fsSL https://get.docker.com | bash -s docker
```

如果您成功安装了 Docker 和 Docker-Compose，可以通过以下命令查看版本：

```bash
docker -v

docker compose version
```


### 拉取配置文件

```bash
cd && mkdir -p mx-space/core && cd $_

# 拉取 docker-compose.yml 文件
wget https://fastly.jsdelivr.net/gh/mx-space/core@master/docker-compose.yml
```

### 配置 Core 启动配置文件

在下方的表格里填入你的配置，然后点击复制，创建一个 `.env` 文件，将复制的内容粘贴进去，保存即可。

> 鼠标悬停在下方的表格中，可以查看对应的配置项名字。

import { EnvVariableConfig } from '@components/EnvVariableConfig';

<EnvVariableConfig 
  variableNames={
    [
      {
        key: 'JWT_SECRET',
        name: "[JWT 密钥] 长度不小于 16 个字符，不大于 32 个字符",
      }, 
      {
        key: 'ALLOWED_ORIGINS',
        name: "[被允许的域名] 如果允许多个域名访问，用英文逗号，分隔",
      }, 
      {
        key: 'ENCRYPT_ENABLE',
        name: "[是否开启加密] true 为开启，false 为关闭",
      }, 
      {
        key: 'ENCRYPT_KEY',
        name: "[加密密钥] 详情请见下方提示",
      },
    ]
  }
/>

- **`JWT 密钥`**：需要填写长度不小于 16 个字符，不大于 32 个字符的字符串，用于加密用户的 JWT，务必保存好自己的密钥，不要泄露给他人。
- **`被允许的域名`**：需要填写被允许的域名，通常是前端的域名，如果允许多个域名访问，用英文逗号，分隔。
- **`是否开启加密`**：如果你确定要开启加密，将 false 改为 true，开启加密后，你需要在下方填写加密密钥。
- **`加密密钥`**：具体内容可参考 https://mx-space.js.org/feature/security.html

<Callout type="warning">
若开启加密，则需注意密钥长度**必须为 64 位**，不然会在初始化时报错。注意这是**不可逆**的，务必保存自己的秘钥。所以并不是非常推荐使用，除非你真的需要加密，
</Callout>

### 启动 Core

```bash
docker compose up -d
```

### 完成

恭喜你完成了 Core 部署，不过仅仅如此是不够的，你需要配置好反向代理之后登录后台进行初始化，这里不再赘述。除此之外，如引言所述还需要部署一个**前端**主题用于展示，请参考 [前端主题文档](https://mx-space.js.org/themes) 继续完成部署前端主题的步骤。

</Steps>

## 相关链接

<Cards num={2}>
  <Card arrow title="反向代理配置" href="/docs/extra#反向代理" icon={<UilExternalLinkAlt />} />
  <Card arrow title="Shiro 部署" href=/themes/shiro" icon={<UilExternalLinkAlt />} />
  <Card arrow title="Kami 部署" href=/themes/kami" icon={<UilExternalLinkAlt />} />
  <Card arrow title="更新 Core" href=/usage/update" icon={<UilArrowCircleUp />} />
</Cards>




